<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Willem (Wim) Kaijser" />


<title>EcoPostView: Ecological Posterior View</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">EcoPostView: Ecological Posterior View</h1>
<h4 class="author">Willem (Wim) Kaijser</h4>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">1.
Introduction</a></li>
<li><a href="#obtaining-data-and-fitting-glms" id="toc-obtaining-data-and-fitting-glms">2. Obtaining data and fitting
(G)LMs</a></li>
<li><a href="#the-meta-function" id="toc-the-meta-function">3. The
meta-function</a>
<ul>
<li><a href="#basic-function" id="toc-basic-function">3.1 Basic
function</a></li>
<li><a href="#setting-priors" id="toc-setting-priors">3.2 Setting
priors</a></li>
<li><a href="#setting-multiple-priors-for-bayesian-model-averaging" id="toc-setting-multiple-priors-for-bayesian-model-averaging">3.3
Setting multiple priors for Bayesian Model Averaging</a></li>
</ul></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>1. Introduction</h1>
<p>Ecological data is scattered around literature in different formats
and very noisy. It is often ‘case-study’ specific and not representative
for the totality if conditions encountered. However, as ecologist you
are not interested in case specific situations, but making probability
statements on general patterns, visualizing and predicting with
them.</p>
<p>If working with meta-data and uncovering patterns from literature,
making predictions and probability statements are your goal, this
R-package can help make your life easier. The goal of this package is
for you combine the benefits of multiple fitted Linear and Generalized
Linear Models ((G)LMs), using the flexibility and strength of Bayesian
Meta-analysis to generalize to a pooled (G)LM. For the differences
differences, strengths and weaknesses of both the classical
(Frequent-ism) or Bayesian approach see <a href="https://snwikaij.shinyapps.io/shiny/" class="uri">https://snwikaij.shinyapps.io/shiny/</a>.</p>
<p>The information you are interested in is available from figures,
tables, data sets or combinations between them. In simple words, we need
a data set on which we can fit a (G)LM (see Kaijser et al, …). This,
however, will show that most data is very noisy, perhaps biased and the
heterogeneity amount studies is large. This is an issue for a focus on
error-control and causality statements. Both need very clearly a
controlled environment with a well setup experimental conditions and
exclusion of confounding variables. Hence, error-control and causality
start a-priori (Fisher 1949, Pearl 2009, Mayo 2018). Of course this
makes or information still useful to make probability statements or
using the information to a-priori setup an study focused on
error-control or causality study. However, the focus lies here on making
posterior probability statements, visualization and prediction possible
this information.</p>
<p>To start usgin the R-package both JAGS and devtools need to be
installed. JAGS can be installed from <a href="https://sourceforge.net/projects/mcmc-jags/" class="uri">https://sourceforge.net/projects/mcmc-jags/</a> and devtools
can be install in R. For the most recent version of the EcoPostView it
can be installed from GitHub. Of course, if nicely asked, any problems
or possible improvements can be directed to me.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#install.packages(&quot;devtools&quot;)</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; Loading required package: usethis</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#install.github(&quot;snwikaij/EcoPostView&quot;)</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(EcoPostView)</span></code></pre></div>
</div>
<div id="obtaining-data-and-fitting-glms" class="section level1">
<h1>2. Obtaining data and fitting (G)LMs</h1>
<p>To obtain data from the (G)LMs we need to fit models. This data can
be obtained from figures (e.g., using WebPlotDigitizer), tables, data
sets or combinations (See Kaijser et al. …). What is needed to combine
these models are the so called estimations of the model parameters.
These are more commonly known as the intercept or slope. The intercept
(<em>b0</em> or <em>β0</em>) and slope (<em>b1</em> or <em>β1</em>) can
be used to predict: <em>link(response variable) = b0 + b1 · predictor
variable</em>. In a GLM the response variable is linked to to the linear
component with a link-function often notated as <em>g(..)</em>. The
‘identity’ link function applies no link function. This indicate that
the mean (expected value notated as <em>E(y)</em> or <em>(E(y|x))</em>)
is directly related to the linear component. However, in a GLM with,
log- or logit-link it is easier to talk about log-linear relation <span class="math display">\[log(E(y \mid x)) = \beta_0 + \beta_1 \cdot
x\]</span> or logit-linear relation <span class="math display">\[logit(E(y \mid x)) = \beta_0 + \beta_1 \cdot
x\]</span> The slope is not a true slope anymore because there is not
straight line anymore between the response and predictor variable.
Therefore the term coefficient or regression coefficient refers to the
model parameter (<em>β</em>). When fitting a model it is convenient to
note the source (e.g., DOI), the type of predictor variable (e.g.,
conductivity), group of the response type (e.g., benthic-invertebrates),
link-function and if the model parameters is the intercept <em>b0</em>
or a regression coefficient <em>b1</em>. If multiple predictor variables
are fitted in a model all regression coefficients as notated as
<em>b1</em> to distinguish it from the intercept <em>b0</em>.</p>
<p>Heuristically, I prefer working often working with elasticity- or
semi-elasticity coefficients (Woolridge, 2001). But there are enough
reasons not to do so and is dependent on the question and many other
factors. The elasticity coefficient expresses the percentage change of
<span class="math inline">\(y\)</span> (response) as relative to <span class="math inline">\(x\)</span> (predictor variable). Thus, 0.2 is 0.2%
change in <span class="math inline">\(y\)</span> given 1% in <span class="math inline">\(x\)</span>. Hence, for a log-linear model <span class="math inline">\(log(E(y \mid x)) = \beta_0 + \beta_1 \cdot
log(x)\)</span> and thus <span class="math inline">\(\beta_1 =
\frac{\log(y)}{\log(x)}\)</span>. For the semi-elasticity coefficient
(i.e., logit-linear) this only accounts partially and values closer 0
are better interpret able because <span class="math inline">\(logit(E(y
\mid x)) = \beta_0 + \beta_1 \cdot log(x)\)</span> and thus <span class="math inline">\(\beta_1 = \frac{logit(y)}{\log(x)}\)</span>. This
expressed the change in the log-odds per 1% elasticity (Cramer 1991;
Woolridge, 2001). This makes it possible to coarsely compare among
different models and still keep the interpretation of to the units
needed for prediction. Hence, we can still predict with the model and
interpret the expected change of <span class="math inline">\(y\)</span>
given an increase in <span class="math inline">\(1·log(x)\)</span>,
because the units of <span class="math inline">\(x\)</span> are retain
under the <span class="math inline">\(log\)</span>.</p>
<p>I will keep these ‘unofficial expression’, due to the reference in
the R-package to <em>b0</em> and <em>b1</em> while a proper notation
would of course be more complex expressed as: <span class="math display">\[g(E(y \mid x_{ij})) = \sum_{j=1}^{v} \beta_j
\cdot x_{ij}\]</span> Where <span class="math inline">\(x_{ij}\)</span>
refers to the <span class="math inline">\(j\)</span> the predictor
variable (e.g., salinity is <span class="math inline">\(j\)</span>=1 and
light is <span class="math inline">\(j\)</span>=2) and <span class="math inline">\(i\)</span> is the <span class="math inline">\(i\)</span>-th observation. Here, <span class="math inline">\(v\)</span> represents the number of predictors. I
will reduce the text to the basics.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(example1)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">head</span>(example1)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt;           group predictor parameter  link  n        est        se</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; 1 Invertebrates  Salinity        b1   log 10  0.0696700 0.2020100</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; 2 Invertebrates    Oxygen        b1   log 10  0.3186800 0.1964600</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; 3 Invertebrates  Salinity        b1   log 10 -0.9498538 0.7231864</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; 4 Invertebrates    Oxygen        b1   log 10 -0.1356232 0.3525578</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; 5 Invertebrates  Salinity        b1 logit 27  0.8249000 0.2038000</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; 6          Fish  Salinity        b1   log 25 -0.1509000 0.1432000</span></span></code></pre></div>
<p>In the example above the column <strong>est</strong> (estimate)
indicates the model parameters and the column <strong>se</strong> the
(standard error of the estimate). The column <strong>group</strong> can
be an organism group or specific species (or anything you wish to group
by), the column <strong>predictor</strong> the specific predictor
variable, the parameter whether the estimate is the intercept
(<em>b0</em>) or a regression coefficient (<em>b1</em>) and the column
<strong>link</strong>* contains the link function. An additional and
recommended option is to include the sample size <strong>n</strong> for
adjusting for ‘small-sample-effect’ (Peters et al., 2006; Moreno et al.,
2009).</p>
</div>
<div id="the-meta-function" class="section level1">
<h1>3. The meta-function</h1>
<div id="basic-function" class="section level2">
<h2>3.1 Basic function</h2>
<p>The meta function can include a random effect, by setting the
argument RE=TRUE (default is TRUE). The structure is then <span class="math inline">\(\beta= \beta_{\text{pooled}} + u_i\)</span>. It
has the option of placing a single or multiple random effect as a vector
or matrix using the argument “random” the structure then becomes then
<span class="math inline">\(\beta = \beta_{\text{pooled}} + u_i
+r_i\)</span> for a single random effect. It can adjust for the relation
between the <span class="math inline">\(se\)</span> and model parameters
using the inverse of the standard error <span class="math inline">\(1/se\)</span> (method=1, Stanley and Doucouliagos,
2014). The structure is then <span class="math inline">\(\beta =
\beta_{\text{pooled}} + u_i + \alpha \cdot
\left(\frac{1}{se}\right)\)</span> or inverse of the sample size <span class="math inline">\(1/n\)</span> (method=2, the latter option is
performed below) with the structure <span class="math inline">\(\beta =
\beta_{\text{pooled}} + u_i + \alpha \cdot
\left(\frac{1}{n}\right)\)</span>. Of course if bias is considered
minimal and neglect able non can be performed (method=1). I still would
like to include a third 4th option to utilize Robust Bayesian Model
Averaging (RoBMA: Maier et al. 2023). But this sometimes adjust
extremely when including <span class="math inline">\(1/se\)</span> and
therefore I left this option open for now.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">meta</span>(<span class="at">estimate=</span>example1<span class="sc">$</span>est,         <span class="co">#Model estimate</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>             <span class="at">stderr=</span>example1<span class="sc">$</span>se,            <span class="co">#Standard error of the model estimate</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>             <span class="at">parameter=</span>example1<span class="sc">$</span>parameter,  <span class="co">#Model parameter (b0 or b1)</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>             <span class="at">predictor=</span>example1<span class="sc">$</span>predictor,  <span class="co">#Predictor variable  (independent variable)</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>             <span class="at">link_function=</span>example1<span class="sc">$</span>link,   <span class="co">#Link function</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>             <span class="at">grouping=</span>example1<span class="sc">$</span>group,       <span class="co">#Group</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>             <span class="at">Nsamp=</span>example1<span class="sc">$</span>n,              <span class="co">#Sample size</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>             <span class="at">method=</span><span class="dv">2</span>)                      <span class="co">#Adjustment method (0=none, 1=Egger&#39;s (1/se), 2=Peters (1/n))</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; Warning in meta(estimate = example1$est, stderr = example1$se, parameter =</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; example1$parameter, : The Rhat or/and effective sample size for some &gt;1.01</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; or/and &lt;1000. Chains might not be mixing.</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#remove model to keep the environment clean</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="fu">rm</span>(mod1)</span></code></pre></div>
<p>The meta-function returns a warnings that the MCMC-chains are not
properly mixing. This can be an issue due to various reasons and
assessed by looking at the ‘raw’ JAGS model output. I will not display
the full output, but can be displayed wit the code below.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#mod1$model$JAGS_model</span></span></code></pre></div>
<p>We can see that for “mu[3]” the effective sample size is 610. Most of
these issues can be resolved by thinning the chains or increasing the
number of chains. In this case n_chain=6 solves the issue. Increasing
the number of chains can be an issue if the number of available cores is
limited as each chain is run on a separate core. Other options are to
set “better informed” or “stronger” priors or combinations between them.
Moreover, if the issue is not an issue of the estimate “mu” parameter in
the raw JAGS output, the issue could be considered to be ignored. These
choices are ultimately up to the user. An option to prevent warnings
would be to set the warning level for Eff_warn lower i.e., Eff_warn =
500.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span><span class="fu">meta</span>(<span class="at">estimate=</span>example1<span class="sc">$</span>est,        </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>            <span class="at">stderr=</span>example1<span class="sc">$</span>se,            </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>            <span class="at">parameter=</span>example1<span class="sc">$</span>parameter,  </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>            <span class="at">predictor=</span>example1<span class="sc">$</span>predictor,  </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>            <span class="at">link_function=</span>example1<span class="sc">$</span>link,   </span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>            <span class="at">grouping=</span>example1<span class="sc">$</span>group,       </span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>            <span class="at">Nsamp=</span>example1<span class="sc">$</span>n,              </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>            <span class="at">method=</span><span class="dv">2</span>,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>            <span class="at">n_chain=</span><span class="dv">6</span>)                   <span class="co">#Increasing the number of chains from 2 to 6   </span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#remove model to keep the environment clean</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="fu">rm</span>(mod2)</span></code></pre></div>
</div>
<div id="setting-priors" class="section level2">
<h2>3.2 Setting priors</h2>
<p>A benefit of the the Bayesian approach is that we can included prior
information. Thereby explicitly shifting the weight of the outcome to
more plausible values of the pooled model parameter or less weight to
less plausible values. To set only a single prior for each relation and
parameter a specific structure is needed. By default the model
parameters are set as Gaussian/normally distributed with a mean (<span class="math inline">\(\mu\)</span>, prior_mu) of 0 and <span class="math inline">\(se\)</span> (prior_mu_se) of 0.5. The prior for
the standard deviation is uniform where only the maximum value
(prior_sigma_max) can be set, which at default is 5. As a strongly
critical side note. The priors do not need to stay the same, because I
“heuristically” like to work with the elasticity- or semi-elasticity
coefficients. THIS IS NOT A NECESSITY. Hence, not thinking about your
prior even if not a lot of information is available to make an very
strong prior (but at least informed) is often not doing a Bayesian
analysis at all.</p>
<p>To get a nice table overview which can be adjusted an filled in with
prior information the argument ‘get_prior_only’ can be set to ‘TRUE’.
This will return a dataframe, with a column <strong>level</strong>
names, priors for the <strong>mu</strong> (<span class="math inline">\(\mu\)</span>) and for the standard error (<span class="math inline">\(se\)</span>). The values in this can be set
manually and re-included as a vector. How to do this will be explained
in more detail in section 3.3.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>only_priors <span class="ot">&lt;-</span> <span class="fu">meta</span>(<span class="at">estimate=</span>example1<span class="sc">$</span>est,        </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                    <span class="at">stderr=</span>example1<span class="sc">$</span>se,            </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                    <span class="at">parameter=</span>example1<span class="sc">$</span>parameter,  </span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>                    <span class="at">predictor=</span>example1<span class="sc">$</span>predictor,  </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>                    <span class="at">link_function=</span>example1<span class="sc">$</span>link,   </span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>                    <span class="at">grouping=</span>example1<span class="sc">$</span>group,       </span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>                    <span class="at">Nsamp=</span>example1<span class="sc">$</span>n,            </span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                    <span class="at">method=</span><span class="dv">2</span>,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>                    <span class="at">n_chain=</span><span class="dv">6</span>,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>                    <span class="at">get_prior_only=</span><span class="cn">TRUE</span>) <span class="co">#Only show the structure of the priors</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="fu">print</span>(only_priors)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt;                            Levels Prior_mu Prior_se</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; 1              b1_Oxygen_log_Fish        0      0.5</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; 2     b1_Oxygen_log_Invertebrates        0      0.5</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; 3            b1_Oxygen_logit_Fish        0      0.5</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; 4   b1_Oxygen_logit_Invertebrates        0      0.5</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; 5            b1_Salinity_log_Fish        0      0.5</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; 6   b1_Salinity_log_Invertebrates        0      0.5</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; 7          b1_Salinity_logit_Fish        0      0.5</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; 8 b1_Salinity_logit_Invertebrates        0      0.5</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#remove data frame of priors to keep environment clean</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="fu">rm</span>(only_priors)</span></code></pre></div>
</div>
<div id="setting-multiple-priors-for-bayesian-model-averaging" class="section level2">
<h2>3.3 Setting multiple priors for Bayesian Model Averaging</h2>
<p>A benefit of the the Bayesian approach is that we can included
multiple priors to perform Bayesian Model Averaging (BMA; Hoeting et
al., 1999; Hinne et al., 2020). Thereby explicitly adding multiple
possible scenarios that could have generated the observable data and
aggregating this possibilities. To set multiple priors we need a similar
dataset but also include prior weights. A simple solution to the prior
weights to weight each prior as equally reasonable. In the example below
there are three priors for each possible model. An the prior weights are
set as 1/3.</p>
<p>The results are summarized in a table describing Maximum A Priori
values (MAP), the <span class="math inline">\(\mu\)</span>, <span class="math inline">\(se\)</span> and the high density intervals at
default (93.1%). Additionally the <span class="math inline">\(I2\)</span> heterogeneity is given.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;example2&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">print</span>(example2)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 7</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt;   Levels                            mu1   se1   mu2   se2   mu3   se3</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; 1 b1_Oxygen_log_Fish                  0   0.5   0.2   0.5   0.2   0.1</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; 2 b1_Oxygen_log_Invertebrates         0   0.5   0.2   0.5   0.2   0.1</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; 3 b1_Oxygen_logit_Fish                0   0.5   0.2   0.5   0.2   0.1</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; 4 b1_Oxygen_logit_Invertebrates       0   0.5   0.2   0.5   0.2   0.1</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; 5 b1_Salinity_log_Fish                0   0.5  -0.2   0.5  -0.2   0.1</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; 6 b1_Salinity_log_Invertebrates       0   0.5  -0.2   0.5  -0.2   0.1</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; 7 b1_Salinity_logit_Fish              0   0.5  -0.2   0.5  -0.2   0.1</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; 8 b1_Salinity_logit_Invertebrates     0   0.5  -0.2   0.5  -0.2   0.1</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">meta</span>(<span class="at">estimate=</span>example1<span class="sc">$</span>est,        </span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>                    <span class="at">stderr=</span>example1<span class="sc">$</span>se,            </span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>                    <span class="at">parameter=</span>example1<span class="sc">$</span>parameter,  </span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>                    <span class="at">predictor=</span>example1<span class="sc">$</span>predictor,  </span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>                    <span class="at">link_function=</span>example1<span class="sc">$</span>link,   </span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>                    <span class="at">grouping=</span>example1<span class="sc">$</span>group,</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>                    <span class="at">prior_mu =</span> example2[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)],          <span class="co">#Prior for the mean</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>                    <span class="at">prior_mu_se =</span> example2[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>)],       <span class="co">#Prior for the standard error of the mean</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>                    <span class="at">prior_weights =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>),       <span class="co">#Prior weights</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>                    <span class="at">Nsamp=</span>example1<span class="sc">$</span>n,            </span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>                    <span class="at">method=</span><span class="dv">2</span>,</span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>                    <span class="at">n_chain =</span> <span class="dv">6</span>)</span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co">#Display the summarized results</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a>mod3<span class="sc">$</span>Summary</span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="co">#&gt;   parameter predictor  link         group     map      mu     se      ll</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="co">#&gt; 1        b1    Oxygen   log          Fish  0.2431  0.2567 0.0990  0.0757</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">#&gt; 2        b1  Salinity   log          Fish -0.0781 -0.0672 0.0698 -0.1894</span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a><span class="co">#&gt; 3        b1    Oxygen logit          Fish  0.1255  0.0147 0.1849 -0.3366</span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="co">#&gt; 4        b1  Salinity logit          Fish -0.1700 -0.1455 0.1104 -0.3388</span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="co">#&gt; 5        b1    Oxygen   log Invertebrates  0.1546  0.1577 0.0577  0.0519</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a><span class="co">#&gt; 6        b1  Salinity   log Invertebrates -0.1515 -0.1525 0.0366 -0.2201</span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a><span class="co">#&gt; 7        b1    Oxygen logit Invertebrates  0.0821  0.0698 0.0938 -0.1012</span></span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a><span class="co">#&gt; 8        b1  Salinity logit Invertebrates -0.2331 -0.2299 0.0551 -0.3288</span></span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a><span class="co">#&gt;        ul     I2</span></span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a><span class="co">#&gt; 1  0.4372 0.5846</span></span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a><span class="co">#&gt; 2  0.0641 0.5804</span></span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a><span class="co">#&gt; 3  0.3082 0.1012</span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a><span class="co">#&gt; 4  0.0655 0.2758</span></span>
<span id="cb7-44"><a href="#cb7-44" tabindex="-1"></a><span class="co">#&gt; 5  0.2619 0.5979</span></span>
<span id="cb7-45"><a href="#cb7-45" tabindex="-1"></a><span class="co">#&gt; 6 -0.0864 0.7354</span></span>
<span id="cb7-46"><a href="#cb7-46" tabindex="-1"></a><span class="co">#&gt; 7  0.2376 0.3190</span></span>
<span id="cb7-47"><a href="#cb7-47" tabindex="-1"></a><span class="co">#&gt; 8 -0.1282 0.2647</span></span>
<span id="cb7-48"><a href="#cb7-48" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" tabindex="-1"></a><span class="co">#remove data frame of priors to keep environment clean</span></span>
<span id="cb7-50"><a href="#cb7-50" tabindex="-1"></a><span class="fu">rm</span>(mod3)</span></code></pre></div>
<p>This is the most difficult part where the data needs to be gathered
and extracted, (G)LMs need to be fitted, priors need to formulated and
the whole model needs to be optimized to get a stable results. The
display of the results requires less time.</p>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Cramer, J. S. 1991. The Logit Model: An Introduction for Economists.
London: Edward Arnold.</p>
<p>Hinne, Max, Quentin F. Gronau, Don Van Den Bergh, and Eric-Jan
Wagenmakers. 2020. “A Conceptual Introduction to Bayesian Model
Averaging.” Advances in Methods and Practices in Psychological Science
3(2):200–215. doi: 10.1177/2515245919898657.</p>
<p>Hoeting, Jennifer A., David Madigan, Adrian E. Raftery, and Chris T.
Volinsky. 1999. “Bayesian Model Averaging: A Tutorial.” Statistical
Science 14(4):382–417. doi: 10.1214/ss/1009212519.</p>
<p>Maier, Maximilian, František Bartoš, and Eric-Jan Wagenmakers. 2023.
“Robust Bayesian Meta-Analysis: Addressing Publication Bias with
Model-Averaging.” Psychological Methods 28(1): 107–22. doi:
10.1037/met0000405.</p>
<p>Moreno, Santiago G., Alex J. Sutton, Ae Ades, Tom D. Stanley, Keith
R. Abrams, Jaime L. Peters, and Nicola J. Cooper. 2009. “Assessment of
Regression-Based Methods to Adjust for Publication Bias through a
Comprehensive Simulation Study.” BMC Medical Research Methodology
9(1):2. doi: 10.1186/1471-2288-9-2.</p>
<p>Peters, Jaime L., Alex J. Sutton, David R. Sones, Keith R. Abrams,
and Lesley Rushton. 2006. “Comparison of Two Methods to Detect
Publication Bias in Meta-Analysis.” JAMA 295(6):676. doi:
10.1001/jama.295.6.676.</p>
<p>Stanley, T. D., and Hristos Doucouliagos. 2014. “Meta-Regression
Approximations to Reduce Publication Selection Bias.” Research Synthesis
Methods 5(1):60–78. doi: 10.1002/jrsm.1095.</p>
<p>Woolridge, Jeffery M. 2001. Econometric Analysis of Cross Section and
Panel Data. Cambridge, Massachusetts, London, England: The MIT
press.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
